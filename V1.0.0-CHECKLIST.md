# V1.0.0 Checklist

Authoritative, versioned checklist for features and quality gates required to ship V1.0.0. Use the checkboxes to track progress; open issues and PRs should reference the relevant item IDs.

Status legend:

- [ ] Todo
- [~] In progress
- [x] Done

---

## Success criteria

- Admin can sign in (email+password) and via OAuth (Google, GitHub), and manage core admin pages without errors.
- Users can register, verify email, log in, reset password.
- Secure-by-default cookies and CSRF protection in place; login throttling/lockout to mitigate brute force.
- OpenAPI and markdown docs are complete and consistent; ReDoc renders cleanly in dark/light.
- SPA routes work in dev/prod (refresh and deep links), and admin APIs are protected via RBAC.
- CI basics: build, lint/typecheck, and tests are green.

---

## 1) Auth — OAuth callbacks (Google, GitHub)

- [x] Backend: Implement OAuth callback endpoints with state validation and code exchange
  - [x] Endpoints: `GET /auth/oauth/google/callback`, `GET /auth/oauth/github/callback`
  - [x] Validate `state` (bind to CSRF/session) and handle missing/invalid state
  - [x] Exchange `code` for tokens with provider (token endpoint)
  - [x] Fetch user profile (email, name, avatar/id) from provider API
  - [x] Link-or-create local user; enforce unique email constraints; record provider id
  - [x] Issue auth cookies (httpOnly, secure, sameSite) for access/refresh; rotate refresh tokens
  - [x] Redirect to frontend success route; include minimal context (e.g., `?ok=1`) and handle errors (e.g., `?error=oauth_failed`)
  - [x] Audit log: success/failure with provider and user id
- [ ] Configuration & secrets
  - [ ] Env vars for client IDs/secrets and allowed redirect URIs
  - [ ] Dev defaults and docs for localhost
- [ ] Tests
  - [ ] Unit tests for handlers (state validation, code exchange, linking)
  - [ ] Integration/E2E flow tests with provider stubs (nock/MSW)
  - [ ] Cookie flags and redirects verified
- [~] Documentation
  - [x] OpenAPI: add OAuth callback endpoints (summary, params, responses)
  - [ ] Auth docs: “Sign in with Google/GitHub” guide with screenshots and provider setup steps
  - [ ] Security section: how state/CSRF is enforced, minimal scopes, redirect safety

## 2) Auth — Email delivery (verification + password reset)

- [ ] Email transport abstraction & provider
  - [ ] Implement provider using Nodemailer; support SMTP (e.g., Postmark/SendGrid/SES) via env config
  - [ ] Dev transport: Console/JSON + optional Mailpit/Mailhog instructions
- [ ] Templates & flows
  - [ ] HTML + text templates for email verification and password reset (accessible, brand-consistent)
  - [ ] Token TTLs, single-use semantics, replay protection
  - [ ] Rate limits for sending (per user/ip) with friendly errors
- [ ] Tests
  - [ ] Unit tests for token generation/validation and email send abstraction
  - [ ] Integration tests: end-to-end register → verify; request reset → reset
- [ ] Documentation
  - [ ] Auth docs: Email setup (env vars, SMTP), troubleshooting
  - [ ] OpenAPI: confirm verification/reset endpoints are fully documented

## 3) Auth — Throttling and lockout

- [ ] Per-IP and per-username throttles on `/auth/login`
- [ ] Temporary account lockout after N failed attempts within a window (configurable)
- [ ] Backoff headers and friendly error messages
- [ ] Tests for threshold behavior, unlock after window, and audit logging
- [ ] Documentation: security notes + operational guidance for tuning limits

## 4) OpenAPI and docs completeness

- [ ] OpenAPI: add `/auth/me` spec with security and responses
- [ ] OpenAPI: add OAuth callback endpoints and error models
- [ ] Ensure securitySchemes reflect cookie-based auth + CSRF notes; tag endpoints consistently
- [ ] ReDoc build: verify no errors/warnings; dark/light themes match site
- [ ] Markdown docs
  - [ ] Add “Security” page covering cookies, SameSite, CSRF, TTLs, refresh rotation, rate limits, password policy
  - [ ] Ensure Auth/Admin docs are consistent, link to OpenAPI sections, and pass markdownlint

## 5) Admin & Audit

- [ ] Audit Logs backend: finalize filters/pagination edge cases and RBAC tests
- [ ] Frontend: polish loading/empty/error states; include export (CSV) if time permits
- [ ] Docs: admin overview + audit usage guide with examples

## 6) SPA routing and dev/prod parity

- [ ] Verify refresh and deep links for `/admin/*` in dev and prod (smoke script)
- [ ] Ensure Vite proxy covers necessary admin/auth/doc endpoints in dev (no JSON/HTML mismatches)
- [ ] Backend SPA fallback: confirm excludes real API routes and serves index.html for client routes

## 7) QA — Build, lint, tests

- [ ] Typecheck (frontend/backend) clean
- [ ] Lint clean (JS/TS + markdownlint)
- [ ] Unit tests: auth, email, oauth, audit
- [ ] E2E smoke: register → verify → login; OAuth login; reset password; admin audit view

## 8) Release hygiene

- [ ] Update CHANGELOG via release-please with scope notes
- [ ] Version bump to 1.0.0 on main
- [ ] Document env var matrix for dev/prod (auth, email, cookies, CORS/proxy)
- [ ] Ops notes: recommended reverse proxy/headers, health checks, and monitoring endpoints

---

## Nice-to-haves (post-V1)

- [ ] Session management UI (list sessions, revoke)
- [ ] Silence dev CSP console warning (refine Helmet/CSP only in prod)
- [ ] Audit Logs: saved filter presets, multi-select actions, CSV export

---

## Fast links and metadata

- Milestone: V1.0.0
- Labels to use: `v1`, `auth`, `oauth`, `email`, `security`, `docs`, `admin`, `qa`
- Owners: TBD (assign per issue/PR)
- Tracking: Mirror each top-level checkbox to a GitHub Issue and add to the `V1.0.0` milestone
