# Service interface migration and DI cleanup

- [x] inventory-di-and-interfaces: Inventory DI usage and service implementations: confirm which services already have interfaces, list constructors and any use of `new PrismaClient()` in services and tests. (This is done/verified) 游댮
- [-] add-missing-service-interfaces: Create TypeScript interfaces for remaining services (AuthService, RateLimitService, PetService, LocationService, EventService, MedicalRecordService, PetOwnerService, OwnerService, UserService) under `src/services/interfaces` and export them from an index file. Infer method signatures from existing service classes. 游댮
- [ ] update-services-to-implement-interfaces: Update service classes to implement their new interfaces, replace any `new PrismaClient()` uses with DI-injected Prisma client, and ensure constructors accept only injected dependencies. 游댮
- [ ] standardize-di-tokens-and-container-wiring: Standardize DI tokens in `src/container.ts` and `tests/helpers/testContainer.ts`. Ensure single registration per service and maintain backward-compatible aliases where required (factory wrapper pattern). 游댮
- [ ] migrate-tests-to-use-test-container: Update tests to use `tests/helpers/testContainer` for wiring services and shared `prismaClient`. Remove ad-hoc `new PrismaClient()` usage in tests. 游리
- [ ] remove-legacy-helpers-and-direct-imports: Replace legacy helpers (e.g., `src/lib/rateLimit.ts`) where possible so application code uses DI services via the interfaces only. Keep minimal wrappers only when necessary. 游리
- [ ] run-tests-and-fix-regressions: After each change, run backend tests unsuppressed. Triage any failing tests and iterate until green; commit and push small incremental changes. 游댮
- [ ] document-di-contracts-and-guides: Add README docs describing DI contracts, how to add services, how to wire test containers, and migration notes under `backend/README.md` or `CONTRIBUTING.md`. 游릭
- [ ] create-branch-and-open-prs: Create a migration branch, make incremental commits for each task above, and open PRs against `main` with CI passing. 游릭